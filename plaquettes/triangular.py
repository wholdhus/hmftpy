import numpy as np


def test_bonds(plaquette):
    good = True
    L = plaquette['L']
    cats = ['inner_n', 'inner_nn', 'inner_nnn', 'outer_n', 'outer_nn', 'outer_nnn']
    correct = {c: [True for i in range(L)] for c in cats}
    for c in cats:
        for i, sites in enumerate(plaquette[c]):
            for s in sites:
                if i in plaquette[c][s]:
                    pass # it's fine
                else:
                    correct[c][i] = False
                    good = False
    return good, correct
                
            
"""
Connection diagram for "small" (7 site)


  <3> <4>-<0>-<1>-<5>-<6>
      / \ / \ / \ /     \
<0>-<1>- 5 - 6 -<2> <3> <4>
  \ / \ /     \ / \     /
  <6>- 2   3   4 -<0>-<1>
    \ / \     / \ / \ /
    <4>- 0 - 1 -<5>-<6>
    / \ / \ / \ /     \
  <1>-<5>-<6>-<2> <3> <4>
      /     \ / \     /
    <2> <3> <4>-<0>-<1>
      \     /
      <0>-<1>
Lattice directions:
Nearest, next-next-nearest:
- = x, / = y, \ = z

Next-nearest, next^3-nearest:
_           _
  \  = a, /   = b, | = c
"""


# Inter couplings: both are real spins
# Outer couplings: 1st is mean field param. index, second is real spin

plaq7 = {'L': 7}
plaq7['inner_n'] = [[1,3,2],
                    [4,3,0],
                    [0,3,5],
                    [0,1,2,4,5,6],
                    [6,3,1],
                    [2,3,6],
                    [5,3,4]]
plaq7['inner_nn'] = [[4,5],
                     [6,2],
                     [1,6],
                     [],
                     [5,0],
                     [0,4],
                     [2,1]]
plaq7['inner_nnn'] = [[6],
                      [5],
                      [4],
                      [],
                      [2],
                      [1],
                      [0]]
sites = np.arange(7)
plaq7['outer_n'] = [sites[[s2 not in np.append(plaq7['inner_n'][s], s) for s2 in sites]] for s in sites]
plaq7['outer_nn'] = [sites[[s2 not in np.append(plaq7['inner_nn'][s], s) for s2 in sites]] for s in sites]
plaq7['outer_nnn'] = [sites[[s2 not in np.append(plaq7['inner_nnn'][s], s) for s2 in sites]] for s in sites]



"""
a = 11
b = 12
Connection diagram for "medium" (12 site)
            <4>-<5>
            / \ / \
      <9>-<0>-<1>-<2>-<7>
        \ / \ / \ / \ /
    <5>-<6>- a - b -<3>-<4>
      \ / \ / \ / \ / \ /
  <1>-<2>- 7 - 8 - 9 -<0>-<1>
    \ / \ / \ / \ / \ / \ /
<a>-<b>- 3 - 4 - 5 - 6 -<a>-<b>
  \ / \ / \ / \ / \ / \ / \ /
  <8>-<9>- 0 - 1 - 2 -<7>-<8>
      / \ / \ / \ / \ / \
    <5>-<6>-<a>-<b>-<3>-<4>
          \ / \ / \ /
          <7>-<8>-<9>


"""
plaq12 = {'L': 12}
plaq12['inner_n'] = [[1,3,4],
                     [0,2,4,5],
                     [1,5,6],
                     [0,4,7],
                     [0,1,3,5,7,8],
                     [1,2,4,6,8,9],
                     [2,5,9],
                     [3,4,8,10],
                     [4,5,7,9,10,11],
                     [5,6,8,11],
                     [7,8,11],
                     [8,9,10]
                     ]
plaq12['inner_nn'] = [[5,7],
                      [3,6,8],
                      [4,9],
                      [1,8],
                      [2,9,10],
                      [0,7,11],
                      [1,8],
                      [0,5,11],
                      [1,3,6],
                      [2,4,10],
                      [4,9],
                      [5,7]]
plaq12['inner_nnn'] = [[2,8],
                       [7,9],
                       [0,8],
                       [5,10],
                       [6,11],
                       [3,10],
                       [4,11],
                       [1,9],
                       [0,2],
                       [1,7],
                       [3,5],
                       [4,6]]
plaq12['outer_n'] = [[6,9,10],
                     [10,11],
                     [3,7,11],
                     [2,9,11],
                     [],
                     [],
                     [0,7,10],
                     [2,6],
                     [],
                     [0,3],
                     [0,1,6],
                     [1,2,3]
                     ]
plaq12['outer_nn'] = [[5,7,11,11], # 0
                      [3,6,8],
                      [4,9,10,10], # 2
                      [1,6,6,8],
                      [2,9,10], # 4
                      [0,7,11],
                      [1,3,3,8], # 6
                      [0,5,11],
                      [1,3,6], # 8
                      [2,4,10],
                      [2,2,4,9], # 10
                      [0,0,5,7]]
plaq12['outer_nnn'] = [[2,2,8,8],
                       [7,7,9,9],
                       [0,0,8,8],
                       [5,5,10,10],
                       [6,6,11,11],
                       [3,3,10,10],
                       [4,4,11,11],
                       [1,1,9,9],
                       [0,0,2,2],
                       [1,1,7,7],
                       [3,3,5,5],
                       [4,4,6,6]]


"""
Connection diagram for "large" (19 site)
           16 -17 -18
           / \ / \ / \
         12 -13 -14 -15
         / \ / \ / \ / \
        7 - 8 - 9 -10 -11
         \ / \ / \ / \ /
          3 - 4 - 5 - 6
           \ / \ / \ /
            0 - 1 - 2

Lattice directions:
Nearest, next-next-nearest:
- = x, / = y, \ = z

Next-nearest, next^3-nearest:
_           _
  \  = a, /   = b, | = c
"""
Lxs = [3, 4, 5, 4, 3]
plaq19 = {'L': 19}
plaq19['inner_n'] = [
                        [1,3,4], # 0
                        [2,5,4,0], # 1
                        [6,5,1], # 2
                        [0,4,8,7], # 3
                        [0,1,5,9,8,3], # 4
                        [2,6,10,9,4,1], # 5
                        [11,10,5,2], # 6
                        [12,8,3], # 7
                        [3,4,9,13,12,7], # 8
                        [4,5,8,10,13,14], # 9
                        [5,6,11,15,14,9], # 10
                        [6,10,15], # 11
                        [7,8,13,16], # 12
                        [8,9,14,17,16,12], # 13
                        [9,10,15,18,17,13], # 14
                        [10,11,14,18], # 15
                        [12,13,17], # 16
                        [13,14,18,16], # 17
                        [17,14,15]] # 18
plaq19['outer_n'] = [
                        [15,11,16], # 0
                        [16,17],
                        [17,18,7], # 2
                        [18,15],
                        [], # 4
                        [],
                        [7,12], # 6
                        [18,2,6],
                        [], # 8
                        [],
                        [], # 10
                        [12,16,0],
                        [11,6], # 12
                        [],
                        [], # 14
                        [0,3],
                        [1,0,11], # 16
                        [1,2],
                        [3,7,2]] # 18
plaq19['inner_nn'] = [
                        [5,8], # 0
                        [6,9,3],
                        [10,4], # 2
                        [1,9,12],
                        [2,10,13,7], # 4
                        [11,14,8,0],
                        [15,9,1], # 6
                        [4,13],
                        [0,5,14,16], # 8
                        [1,6,15,17,12,3],
                        [2,18,13,4], # 10
                        [5,14],
                        [3,9,17], # 12
                        [7,4,10,18],
                        [5,11,16,8], # 14
                        [6,9,17],
                        [8,14], # 16
                        [12,9,15],
                        [13,10]] # 18
plaq19['outer_nn'] = [
                        [18,10,12,17], # 0
                        [11,13,18],
                        [16,14,3,12], # 2
                        [2,14,11],
                        [15,16], # 4
                        [17,7],
                        [18,8,16], # 6
                        [11,5,17,15],
                        [6,18], # 8
                        [],
                        [12,0], # 10
                        [7,13,1,3],
                        [0,10,2], # 12
                        [1,11],
                        [3,2], # 14
                        [16,4,7],
                        [2,15,6,4], # 16
                        [7,5,0],
                        [0,8,6,1]] # 18
plaq19['inner_nnn'] = [
                        [2,9,7], # 0
                        [10,8],
                        [11,9,0], # 2
                        [5,13],
                        [6,14,12], # 4
                        [15,13,3],
                        [14,4], # 6
                        [0,9,16],
                        [1,10,17], # 8
                        [0,2,7,11,16,18],
                        [1,17,8], # 10
                        [2,9,18],
                        [4,14], # 12
                        [3,5,15],
                        [4,6,12], # 14
                        [5,13],
                        [7,9,18], # 16
                        [8,10],
                        [9,11,16]] # 18
plaq19['outer_nnn'] = [
                        [14,6,13], # 0
                        [15,12,14,7],
                        [13,15,8], # 2
                        [6,16,10,17],
                        [18,11,17], # 4
                        [16,18,12],
                        [17,3,13,0], # 6
                        [10,1,14],
                        [11,2,15], # 8
                        [],
                        [7,16,3], # 10
                        [8,17,4],
                        [1,15,5,18], # 12
                        [2,0,6],
                        [0,7,1], # 14
                        [2,8,1,12],
                        [5,3,10], # 16
                        [3,6,4,11],
                        [4,12,5]] # 18


"""
Connection diagram for "medium" (12 site) with specific BC to match paper

       <0>-<1>-<2>
       / \ / \ / \
     <6>-10 -11 -<3>
     / \ / \ / \ / \
   <2>- 7 - 8 - 9 -<0>
     \ / \ / \ / \ /
      3 - 4 - 5 - 6
       \ / \ / \ /
        0 - 1 - 2
"""


plaq12_hex = {'L': 12}
plaq12_hex['inner_n'] = [[1,3,4],
                     [0,2,4,5],
                     [1,5,6],
                     [0,4,7],
                     [0,1,3,5,7,8],
                     [1,2,4,6,8,9],
                     [2,5,9],
                     [3,4,8,10],
                     [4,5,7,9,10,11],
                     [5,6,8,11],
                     [7,8,11],
                     [8,9,10]
                     ]
plaq12_hex['inner_nn'] = []
plaq12_hex['inner_nnn'] = []
plaq12_hex['outer_n'] = [[6,9,10],
                     [10,11],
                     [3,7,11],
                     [2,9,11],
                     [],
                     [],
                     [0,7,10],
                     [2,6],
                     [],
                     [0,3],
                     [0,1,6],
                     [1,2,3]
                     ]
plaq12_hex['outer_nn'] = []
plaq12_hex['outer_nnn'] = []